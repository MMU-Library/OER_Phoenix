{% extends 'base.html' %}
{% block content %}
<h1>Talis Push Jobs</h1>
<p>Recent Talis push jobs (staff only).</p>
<table class="table table-striped">
  <thead>
    <tr>
      <th>ID</th>
      <th>Created</th>
      <th>Started</th>
      <th>Completed</th>
      <th>Status</th>
      <th>Target URL</th>
      <th>Response</th>
    </tr>
  </thead>
  <tbody>
    {% for job in jobs %}
    <tr>
      <td>{{ job.id }}</td>
      <td>{{ job.created_at }}</td>
      <td>{{ job.started_at|default:"-" }}</td>
      <td>{{ job.completed_at|default:"-" }}</td>
      <td>{{ job.get_status_display }}</td>
      <td><a href="{{ job.target_url }}" target="_blank">{{ job.target_url|truncatechars:60 }}</a></td>
      <td>
        {% if job.response_code %}
          {{ job.response_code }}
        {% else %}
          {% if job.response_body %}
            {{ job.response_body|truncatechars:80 }}
          {% else %}
            -
          {% endif %}
        {% endif %}
      </td>
    </tr>
    {% empty %}
    <tr><td colspan="7">No Talis push jobs found.</td></tr>
    {% endfor %}
  </tbody>
</table>
<p><a class="btn btn-default" href="{% url 'resources:talis_csv_upload' %}">Back to Talis upload</a></p>
{% endblock %}
